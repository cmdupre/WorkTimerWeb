(()=>{"use strict";const t={getRuntimeString:t=>{let e=Math.floor(t/3600),n=Math.floor(t%3600/60),s=Math.floor(t%3600%60);return e=e<10?"0"+e:e,n=n<10?"0"+n:n,s=s<10?"0"+s:s,`${e}:${n}:${s}`}},e=t=>t.split("").reverse().join("");function n(n){let s=n.startTime,a=n.tempRuntime,r=n.description;function o(){return s>0?Math.floor((a+Date.now()-s)/1e3):Math.floor(a/1e3)}return{start:()=>s=Date.now(),changeRuntime:function(t){let n=0,s=0,r=0;const o=e(t);t.length>0&&(r=parseInt(e(o.substr(0,2)))),t.length>2&&(s=60*parseInt(e(o.substr(2,2)))),t.length>4&&(n=3600*parseInt(e(o.substr(4)))),a=1e3*(n+s+r)},isRunning:()=>0!==s,getDescription:()=>r,setDescription:t=>r=t,runtime:()=>t.getRuntimeString(o()),stop:function(){s>0&&(a+=Date.now()-s,s=0)},getRuntimeSeconds:o,toObject:function(){return{startTime:s,tempRuntime:a,description:r}}}}const s={create:function(t=0,e=0,s=""){return n({startTime:t,tempRuntime:e,description:s})},createFromObject:n};const a={storeTasks:function(t=null){const e=[],n=t?.getElementsByClassName("task");for(const t of n)t.task.setDescription(t.getElementsByClassName("description")[0].value),e.push(t.task.toObject());localStorage.setItem("tasks",JSON.stringify(e))},getTaskItems:()=>JSON.parse(localStorage.getItem("tasks")||"[]")},r=document.getElementById("content");let o=null,i=null,l=null;function c(t=null,e=null){if(!l)return l=t.target.parentElement,e(t.target.parentElement),void t.target.select();l=null}function u(t){let e="";for(const n of t.target.value)isNaN(n)||(e+=n);t.target.parentElement.task.changeRuntime(e),c(),a.storeTasks(r)}const d={getDiv:()=>r,createTotalizer:function(){if(i)return;const t=document.createElement("label");t.id="totalizer",t.textContent="00:00:00",t.classList.add("disabled"),r.appendChild(t),i=t},createRestoreButton:function(t=null){const e=document.createElement("button");e.id="restoreButton",e.textContent="restore",e.addEventListener("click",t),r.appendChild(e)},createStartButton:function(t=null){if(o)return;const e=document.createElement("button");e.id="startButton",e.textContent="New Task",e.classList.add("new"),e.addEventListener("click",t),r.appendChild(e),o=e},disableRestoreButton:function(t=null){restoreButton.removeEventListener("click",t),restoreButton.classList.add("label"),restoreButton.textContent="Total:",i.classList.remove("disabled")},createNewTask:function(t){const e=document.createElement("button");e.classList.add("timer"),null===t.task||t.task.isRunning()?(e.classList.add("stop"),e.textContent="Stop"):(e.classList.add("start"),e.textContent="Start"),e.addEventListener("click",t.toggleTimer);const n=document.createElement("button");n.classList.add("discard"),n.textContent="discard",n.addEventListener("click",t.discardTask);const s=document.createElement("input");s.classList.add("runtime"),s.placeholder="0:00:00",s.addEventListener("focusin",(e=>c(e,t.stopTask))),s.addEventListener("focusout",u);const i=document.createElement("input");i.classList.add("description"),i.placeholder="describe your task...",i.addEventListener("change",(()=>a.storeTasks(r)));const l=document.createElement("div");return l.description=i,l.classList.add("task"),l.appendChild(e),l.appendChild(n),l.appendChild(s),l.appendChild(i),r.insertBefore(l,o),i.focus(),l},updateTotalizer:function(){if(l)return;let e=0;const n=r.getElementsByClassName("task");for(const t of n)e+=t.task.getRuntimeSeconds();i.textContent=t.getRuntimeString(e)},updateRuntimes:function(){const t=r.children;for(const e of t)void 0!==e.task&&e!==l&&(e.getElementsByClassName("runtime")[0].value=e.task.runtime())}};function m(){d.disableRestoreButton(m);for(const t of a.getTaskItems())E(0,s.createFromObject(t))}function p(t){"Stop"===t.target.textContent?(t.target.parentElement.task.stop(),t.target.textContent="Start",t.target.classList.remove("stop"),t.target.classList.add("start")):(f(),t.target.parentElement.task.start(),t.target.textContent="Stop",t.target.classList.remove("start"),t.target.classList.add("stop")),a.storeTasks(d.getDiv())}function g(t){delete t.target.parentElement.task,t.target.parentElement.parentElement.removeChild(t.target.parentElement),a.storeTasks(d.getDiv())}function f(){const t=d.getDiv().children;for(const e of t)void 0!==e.task&&k(e)}function k(t){t.getElementsByClassName("timer")[0].textContent="Start",t.getElementsByClassName("timer")[0].classList.remove("stop"),t.getElementsByClassName("timer")[0].classList.add("start"),t.task.stop()}function E(t,e=null){null===e&&(d.disableRestoreButton(m),f());const n={task:e,toggleTimer:p,discardTask:g,stopTask:k},r=d.createNewTask(n);null===e?(r.task=s.create(),r.task.start(),a.storeTasks(d.getDiv())):(r.task=e,r.description.value=r.task.getDescription())}d.createStartButton(E),d.createRestoreButton(m),d.createTotalizer(),setInterval(d.updateRuntimes,500),setInterval(d.updateTotalizer,500)})();