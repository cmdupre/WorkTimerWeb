(()=>{"use strict";const t={getRuntimeString:t=>{let e=Math.floor(t/3600),n=Math.floor(t%3600/60),s=Math.floor(t%3600%60);return e=e<10?"0"+e:e,n=n<10?"0"+n:n,s=s<10?"0"+s:s,`${e}:${n}:${s}`}},e=t=>t.split("").reverse().join("");function n(n){let s=n.startTime,a=n.tempRuntime,o=n.description;function r(){return s>0?Math.floor((a+Date.now()-s)/1e3):Math.floor(a/1e3)}return{start:()=>s=Date.now(),changeRuntime:function(t){let n=0,s=0,o=0;const r=e(t);t.length>0&&(o=parseInt(e(r.substr(0,2)))),t.length>2&&(s=60*parseInt(e(r.substr(2,2)))),t.length>4&&(n=3600*parseInt(e(r.substr(4)))),a=1e3*(n+s+o)},isRunning:()=>0!==s,getDescription:()=>o,setDescription:t=>o=t,runtime:()=>t.getRuntimeString(r()),stop:function(){s>0&&(a+=Date.now()-s,s=0)},getRuntimeSeconds:r,toObject:function(){return{startTime:s,tempRuntime:a,description:o}}}}const s={create:function(t=0,e=0,s=""){return n({startTime:t,tempRuntime:e,description:s})},createFromObject:n};const a={storeTasks:function(t=null){const e=[],n=t?.getElementsByClassName("task");for(const t of n)t.task.setDescription(t.getElementsByClassName("description")[0].value),e.push(t.task.toObject());localStorage.setItem("tasks",JSON.stringify(e))},getTaskItems:()=>JSON.parse(localStorage.getItem("tasks")||"[]")},o=document.getElementById("content");let r=null,i=null,c=!1;function l(t=null,e=null){c||(e(),t.target.select()),c=!c}function u(t){let e="";for(const n of t.target.value)isNaN(n)||(e+=n);t.target.parentElement.task.changeRuntime(e),l(),a.storeTasks(o)}const d={getDiv:()=>o,createTotalizer:function(){if(i)return;const t=document.createElement("label");t.id="totalizer",t.textContent="00:00:00",t.classList.add("disabled"),o.appendChild(t),i=t},createRestoreButton:function(t=null){const e=document.createElement("button");e.id="restoreButton",e.textContent="restore",e.addEventListener("click",t),o.appendChild(e)},createStartButton:function(t=null){if(r)return;const e=document.createElement("button");e.id="startButton",e.textContent="New Task",e.classList.add("new"),e.addEventListener("click",t),o.appendChild(e),r=e},disableRestoreButton:function(t=null){restoreButton.removeEventListener("click",t),restoreButton.classList.add("label"),restoreButton.textContent="Total:",i.classList.remove("disabled")},createNewTask:function(t){const e=document.createElement("button");e.classList.add("timer"),null===t.task||t.task.isRunning()?(e.classList.add("stop"),e.textContent="Stop"):(e.classList.add("start"),e.textContent="Start"),e.addEventListener("click",t.toggleTimer);const n=document.createElement("button");n.classList.add("discard"),n.textContent="discard",n.addEventListener("click",t.discardTask);const s=document.createElement("input");s.classList.add("runtime"),s.placeholder="0:00:00",s.addEventListener("focusin",(e=>l(e,t.stopTasks))),s.addEventListener("focusout",u);const i=document.createElement("input");i.classList.add("description"),i.placeholder="describe your task...",i.addEventListener("change",(()=>a.storeTasks(o)));const c=document.createElement("div");return c.description=i,c.classList.add("task"),c.appendChild(e),c.appendChild(n),c.appendChild(s),c.appendChild(i),o.insertBefore(c,r),i.focus(),c},updateTotalizer:function(){if(c)return;let e=0;const n=o.getElementsByClassName("task");for(const t of n)e+=t.task.getRuntimeSeconds();i.textContent=t.getRuntimeString(e)},updateRuntimes:function(){if(c)return;const t=o.children;for(const e of t)void 0!==e.task&&(e.getElementsByClassName("runtime")[0].value=e.task.runtime())}};function m(){d.disableRestoreButton(m);for(const t of a.getTaskItems())k(0,s.createFromObject(t))}function p(t){"Stop"===t.target.textContent?(t.target.parentElement.task.stop(),t.target.textContent="Start",t.target.classList.remove("stop"),t.target.classList.add("start")):(t.target.parentElement.task.start(),t.target.textContent="Stop",t.target.classList.remove("start"),t.target.classList.add("stop")),a.storeTasks(d.getDiv())}function g(t){delete t.target.parentElement.task,t.target.parentElement.parentElement.removeChild(t.target.parentElement),a.storeTasks(d.getDiv())}function f(){const t=d.getDiv().children;for(const e of t)void 0!==e.task&&(e.getElementsByClassName("timer")[0].textContent="Start",e.getElementsByClassName("timer")[0].classList.remove("stop"),e.getElementsByClassName("timer")[0].classList.add("start"),e.task.stop())}function k(t,e=null){null===e&&(d.disableRestoreButton(m),f());const n={task:e,toggleTimer:p,discardTask:g,stopTasks:f},o=d.createNewTask(n);null===e?(o.task=s.create(),o.task.start(),a.storeTasks(d.getDiv())):(o.task=e,o.description.value=o.task.getDescription())}d.createStartButton(k),d.createRestoreButton(m),d.createTotalizer(),setInterval(d.updateRuntimes,500),setInterval(d.updateTotalizer,500)})();